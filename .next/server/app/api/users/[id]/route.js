(()=>{var e={};e.id=100,e.ids=[100],e.modules={193:(e,r,t)=>{"use strict";t.d(r,{M:()=>a});var s=t(6010);async function a(e,r,t,a){try{await s.db.activityLog.create({data:{userId:e,action:r,entity:t||"",entityId:a||""}})}catch(e){console.error("[LOG_ACTIVITY_ERROR]",e)}}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1098:(e,r,t)=>{"use strict";t.d(r,{nr:()=>n});var s=t(3205),a=t.n(s);function n(e){try{return a().verify(e,process.env.JWT_SECRET)}catch{return null}}t(6010)},1640:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>U,routeModule:()=>R,serverHooks:()=>f,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>E});var s={};t.r(s),t.d(s,{DELETE:()=>x,GET:()=>c,PUT:()=>l});var a=t(6559),n=t(8088),i=t(7719),o=t(2190),u=t(6010),d=t(1098),p=t(193);async function c(e,r){try{let t=e.headers.get("authorization")?.replace("Bearer ",""),s=await (0,d.nr)(t),{id:a}=r.params;if(!s||"admin"!==s.role&&s.id!==a)return o.NextResponse.json({error:"Unauthorized"},{status:403});let n=await u.db.user.findUnique({where:{id:a},include:{company:!0,UserTrades:{include:{trade:!0}}}});if(!n)return o.NextResponse.json({error:"User not found"},{status:404});return o.NextResponse.json(n)}catch(e){return console.error("[GET_USER_ERROR]",e),o.NextResponse.json({error:"Server error"},{status:500})}}async function l(e,r){try{let t=e.headers.get("authorization")?.replace("Bearer ",""),s=await (0,d.nr)(t),{id:a}=r.params;if(!s||s.id!==a)return o.NextResponse.json({error:"Unauthorized"},{status:403});let{name:n,phone:i,fax:c,address:l}=await e.json(),x=await u.db.user.update({where:{id:a},data:{name:n,phone:i,fax:c,address:l}});return await (0,p.M)(s.id.toString(),"USER_UPDATED","User",a),o.NextResponse.json(x)}catch(e){return console.error("[UPDATE_USER_ERROR]",e),o.NextResponse.json({error:"Update failed"},{status:500})}}async function x(e,r){try{let t=e.headers.get("authorization")?.replace("Bearer ",""),s=await (0,d.nr)(t),{id:a}=r.params;if(!s||"admin"!==s.role)return o.NextResponse.json({error:"Unauthorized"},{status:403});return await u.db.user.delete({where:{id:a}}),await (0,p.M)(s.id.toString(),"USER_DELETED","User",a),o.NextResponse.json({message:"User deleted"})}catch(e){return console.error("[DELETE_USER_ERROR]",e),o.NextResponse.json({error:"Delete failed"},{status:500})}}let R=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/users/[id]/route",pathname:"/api/users/[id]",filename:"route",bundlePath:"app/api/users/[id]/route"},resolvedPagePath:"C:\\Users\\aande\\buildx-backend\\app\\api\\users\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:E,serverHooks:f}=R;function U(){return(0,i.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:E})}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5511:e=>{"use strict";e.exports=require("crypto")},6010:(e,r,t)=>{"use strict";t.d(r,{db:()=>a});let s=require("@prisma/client"),a=globalThis.prisma??new s.PrismaClient},6487:()=>{},7910:e=>{"use strict";e.exports=require("stream")},8335:()=>{},8354:e=>{"use strict";e.exports=require("util")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9428:e=>{"use strict";e.exports=require("buffer")}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[447,580,205],()=>t(1640));module.exports=s})();