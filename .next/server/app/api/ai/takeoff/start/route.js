(()=>{var e={};e.id=364,e.ids=[364],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5311:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>j,routeModule:()=>k,serverHooks:()=>P,workAsyncStorage:()=>b,workUnitAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{POST:()=>h});var a=r(6559),o=r(8088),i=r(7719),n=r(2190),u=r(6010),p=r(9055),d=r(5511);let f={randomUUID:d.randomUUID},c=new Uint8Array(256),l=c.length,m=[];for(let e=0;e<256;++e)m.push((e+256).toString(16).slice(1));let g=function(e,t,r){if(f.randomUUID&&!t&&!e)return f.randomUUID();let s=(e=e||{}).random??e.rng?.()??(l>c.length-16&&((0,d.randomFillSync)(c),l=0),c.slice(l,l+=16));if(s.length<16)throw Error("Random bytes length must be >= 16");if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=s[e];return t}return function(e,t=0){return(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase()}(s)};async function h(e){let t=e.user;if(!(0,p.H)(t.role,t.planTier,"aiTakeoffs"))return n.NextResponse.json({message:" M-+ Upgrade to access AI Takeoffs."},{status:403});let{projectId:r,fileId:s}=await e.json();try{let e=await u.db.aiTakeoff.create({data:{userId:t.id.toString(),projectId:r,fileId:s,status:"pending",jobId:g()}});return n.NextResponse.json({message:"AI takeoff started",takeoff:e},{status:201})}catch(e){return console.error("[AI_TAKEOFF_START_ERROR]",e),n.NextResponse.json({message:"Failed to start AI takeoff",error:e.message},{status:500})}}let k=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/ai/takeoff/start/route",pathname:"/api/ai/takeoff/start",filename:"route",bundlePath:"app/api/ai/takeoff/start/route"},resolvedPagePath:"C:\\Users\\aande\\buildx-backend\\app\\api\\ai\\takeoff\\start\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:b,workUnitAsyncStorage:x,serverHooks:P}=k;function j(){return(0,i.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:x})}},5511:e=>{"use strict";e.exports=require("crypto")},6010:(e,t,r)=>{"use strict";r.d(t,{db:()=>a});let s=require("@prisma/client"),a=globalThis.prisma??new s.PrismaClient},6487:()=>{},8335:()=>{},9055:(e,t,r)=>{"use strict";r.d(t,{H:()=>a});let s=(e,t)=>({gc_starter:{aiTakeoffs:0,projectsPerMonth:5,aiEstimation:!1,smartProposal:!1,bidConfidence:!1},gc_growth:{aiTakeoffs:10,projectsPerMonth:10,aiEstimation:!1,smartProposal:!1,bidConfidence:!0},gc_unlimited:{aiTakeoffs:9999,projectsPerMonth:9999,aiEstimation:!0,smartProposal:!0,bidConfidence:!0},sub_verified_pro:{aiTakeoffs:0,projectsPerMonth:0,aiEstimation:!1,smartProposal:!1,bidConfidence:!1},sub_elite_partner:{aiTakeoffs:5,projectsPerMonth:0,aiEstimation:!1,smartProposal:!1,bidConfidence:!0},ae_professional:{aiTakeoffs:0,projectsPerMonth:5,aiEstimation:!1,smartProposal:!1,bidConfidence:!1},ae_enterprise:{aiTakeoffs:10,projectsPerMonth:9999,aiEstimation:!0,smartProposal:!0,bidConfidence:!0}})[`${e}_${t}`]||null;function a(e,t,r){let a=s(e,t);return!!a&&!!a[r]}},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,580],()=>r(5311));module.exports=s})();